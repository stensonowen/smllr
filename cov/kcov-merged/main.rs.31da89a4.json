var data = {lines:[
{"lineNum":"    1","line":"extern crate clap;","class":"lineCov","hits":"1","order":"1",},
{"lineNum":"    2","line":"extern crate env_logger;"},
{"lineNum":"    3","line":"#[macro_use]"},
{"lineNum":"    4","line":"extern crate log;"},
{"lineNum":"    5","line":"extern crate md5;"},
{"lineNum":"    6","line":"extern crate regex;"},
{"lineNum":"    7","line":""},
{"lineNum":"    8","line":"use clap::{App, Arg};"},
{"lineNum":"    9","line":""},
{"lineNum":"   10","line":"use std::path::Path;"},
{"lineNum":"   11","line":"use std::ffi::OsStr;"},
{"lineNum":"   12","line":""},
{"lineNum":"   13","line":"pub mod walker;"},
{"lineNum":"   14","line":"use walker::DirWalker;"},
{"lineNum":"   15","line":""},
{"lineNum":"   16","line":"pub mod vfs;"},
{"lineNum":"   17","line":"use vfs::RealFileSystem;"},
{"lineNum":"   18","line":""},
{"lineNum":"   19","line":"pub mod catalog;"},
{"lineNum":"   20","line":"use catalog::FileCataloger;"},
{"lineNum":"   21","line":""},
{"lineNum":"   22","line":"pub mod actor;"},
{"lineNum":"   23","line":"use actor::{FileActor, FileDeleter, FileLinker, FilePrinter};"},
{"lineNum":"   24","line":"use actor::selector::{DateSelect, PathSelect, Selector};"},
{"lineNum":"   25","line":""},
{"lineNum":"   26","line":""},
{"lineNum":"   27","line":"/// Uniquely identify a file by its device id and inode"},
{"lineNum":"   28","line":"#[derive(Clone, Copy, Hash, PartialEq, Eq)]","class":"lineCov","hits":"1","order":"546",},
{"lineNum":"   29","line":"pub struct ID {"},
{"lineNum":"   30","line":"    dev: u64,","class":"lineCov","hits":"1","order":"547",},
{"lineNum":"   31","line":"    inode: u64,","class":"lineCov","hits":"1","order":"548",},
{"lineNum":"   32","line":"}"},
{"lineNum":"   33","line":""},
{"lineNum":"   34","line":"/// Represent the first K bytes of a file"},
{"lineNum":"   35","line":"#[derive(Debug, Hash, PartialEq, Eq, Clone)]","class":"lineCov","hits":"1","order":"571",},
{"lineNum":"   36","line":"pub struct FirstBytes(pub(crate) [u8; FIRST_K_BYTES]);","class":"lineCov","hits":"1","order":"572",},
{"lineNum":"   37","line":"const FIRST_K_BYTES: usize = 32;"},
{"lineNum":"   38","line":""},
{"lineNum":"   39","line":"/// Represent the md5 hash of a complete file"},
{"lineNum":"   40","line":"pub type Hash = [u8; 16];"},
{"lineNum":"   41","line":""},
{"lineNum":"   42","line":""},
{"lineNum":"   43","line":"fn main() {"},
{"lineNum":"   44","line":"    // build arg parser"},
{"lineNum":"   45","line":"    let matches = App::new(\"smllr\")"},
{"lineNum":"   46","line":"        // paths without an argument after"},
{"lineNum":"   47","line":"        .arg(Arg::with_name(\"paths\")"},
{"lineNum":"   48","line":"             .help(\"List of files or directories to deduplicate\")"},
{"lineNum":"   49","line":"             .multiple(true)"},
{"lineNum":"   50","line":"             .takes_value(true)"},
{"lineNum":"   51","line":"             .required(true)"},
{"lineNum":"   52","line":"             )"},
{"lineNum":"   53","line":"        // paths to skip (`--skip /tmp --skip /usr`)"},
{"lineNum":"   54","line":"        .arg(Arg::with_name(\"bad_paths\")"},
{"lineNum":"   55","line":"             .long(\"skip\")"},
{"lineNum":"   56","line":"             .short(\"x\")"},
{"lineNum":"   57","line":"             .help(\"A folder or filename to omit\")"},
{"lineNum":"   58","line":"             .multiple(true)"},
{"lineNum":"   59","line":"             .takes_value(true)"},
{"lineNum":"   60","line":"             )"},
{"lineNum":"   61","line":"        // regex to skip / include"},
{"lineNum":"   62","line":"        .arg(Arg::with_name(\"bad_regex\")"},
{"lineNum":"   63","line":"             .short(\"o\")"},
{"lineNum":"   64","line":"             .long(\"skip-re\")"},
{"lineNum":"   65","line":"             .help(\"Files whose filenames match a blacklisted regex will be skipped\")"},
{"lineNum":"   66","line":"             .multiple(true)"},
{"lineNum":"   67","line":"             .takes_value(true)"},
{"lineNum":"   68","line":"             )"},
{"lineNum":"   69","line":"        // paranoid flag"},
{"lineNum":"   70","line":"        .arg(Arg::with_name(\"paranoid\")"},
{"lineNum":"   71","line":"             .short(\"p\")"},
{"lineNum":"   72","line":"             .long(\"paranoid\")"},
{"lineNum":"   73","line":"             .help(\"Use SHA-3 to hash files instead of MD5\")"},
{"lineNum":"   74","line":"             )"},
{"lineNum":"   75","line":"        // determine selector"},
{"lineNum":"   76","line":"        .arg(Arg::with_name(\"path-len\")"},
{"lineNum":"   77","line":"             .long(\"path-len\")"},
{"lineNum":"   78","line":"             .conflicts_with(\"newest-file\")"},
{"lineNum":"   79","line":"             .help(\"Preserve the file closest to the root (default)\")"},
{"lineNum":"   80","line":"             )"},
{"lineNum":"   81","line":"        .arg(Arg::with_name(\"newest-file\")"},
{"lineNum":"   82","line":"             .long(\"newest-file\")"},
{"lineNum":"   83","line":"             .help(\"Preserve the file that was made most recently\")"},
{"lineNum":"   84","line":"             )"},
{"lineNum":"   85","line":"        .arg(Arg::with_name(\"invert-selector\")"},
{"lineNum":"   86","line":"             .long(\"invert-selector\")"},
{"lineNum":"   87","line":"             .help(\"Invert the selector criterion (e.g. preserve the deepest file)\")"},
{"lineNum":"   88","line":"             )"},
{"lineNum":"   89","line":"        // determine actor"},
{"lineNum":"   90","line":"        .arg(Arg::with_name(\"print\")"},
{"lineNum":"   91","line":"             .long(\"print\")"},
{"lineNum":"   92","line":"             .conflicts_with(\"delete\")"},
{"lineNum":"   93","line":"             .conflicts_with(\"link\")"},
{"lineNum":"   94","line":"             .help(\"Print duplicate files (default)\")"},
{"lineNum":"   95","line":"             )"},
{"lineNum":"   96","line":"        .arg(Arg::with_name(\"delete\")"},
{"lineNum":"   97","line":"             .conflicts_with(\"link\")"},
{"lineNum":"   98","line":"             .long(\"delete\")"},
{"lineNum":"   99","line":"             .help(\"Delete duplicate files\")"},
{"lineNum":"  100","line":"             )"},
{"lineNum":"  101","line":"        .arg(Arg::with_name(\"link\")"},
{"lineNum":"  102","line":"             .long(\"link\")"},
{"lineNum":"  103","line":"             .help(\"Replace duplicate files with hard links\")"},
{"lineNum":"  104","line":"             )"},
{"lineNum":"  105","line":"        .get_matches();"},
{"lineNum":"  106","line":""},
{"lineNum":"  107","line":"    // decide which files are fair game"},
{"lineNum":"  108","line":"    let dirs: Vec<&OsStr> = matches.values_of_os(\"paths\").unwrap().collect();"},
{"lineNum":"  109","line":"    // if the user supplied blacklisted paths, collect them"},
{"lineNum":"  110","line":"    let dirs_n: Vec<&OsStr> = if matches.is_present(\"bad_paths\") {"},
{"lineNum":"  111","line":"        matches.values_of_os(\"bad_paths\").unwrap().collect()"},
{"lineNum":"  112","line":"    } else {"},
{"lineNum":"  113","line":"        vec![]"},
{"lineNum":"  114","line":"    };"},
{"lineNum":"  115","line":"    // if the user supplied blacklisted file regexes, collect them"},
{"lineNum":"  116","line":"    let pats_n: Vec<_> = if matches.is_present(\"bad_regex\") {"},
{"lineNum":"  117","line":"        matches.values_of(\"bad_regex\").unwrap().collect()"},
{"lineNum":"  118","line":"    } else {"},
{"lineNum":"  119","line":"        vec![]"},
{"lineNum":"  120","line":"    };"},
{"lineNum":"  121","line":""},
{"lineNum":"  122","line":"    // print log info to stderr"},
{"lineNum":"  123","line":"    // to alter granularity, set environmental variable RUST_LOG"},
{"lineNum":"  124","line":"    // e.g. `RUST_LOG=debug ./smllr ... 2> /tmp/smllr_log`"},
{"lineNum":"  125","line":"    env_logger::init().unwrap();"},
{"lineNum":"  126","line":""},
{"lineNum":"  127","line":"    // create and customize a DirWalker over the real filesystem"},
{"lineNum":"  128","line":"    // collect all relevant files"},
{"lineNum":"  129","line":"    let fs = RealFileSystem;"},
{"lineNum":"  130","line":"    let paths: Vec<&Path> = dirs.iter().map(Path::new).collect();"},
{"lineNum":"  131","line":"    let dw = DirWalker::new(fs, &paths)"},
{"lineNum":"  132","line":"        .blacklist_folders(dirs_n)"},
{"lineNum":"  133","line":"        .blacklist_patterns(pats_n);"},
{"lineNum":"  134","line":"    let files = dw.traverse_all();"},
{"lineNum":"  135","line":""},
{"lineNum":"  136","line":"    // catalog all files from the DirWalker"},
{"lineNum":"  137","line":"    // duplicates are identified as files are inserted one at a time"},
{"lineNum":"  138","line":"    let mut fc = FileCataloger::new(fs);"},
{"lineNum":"  139","line":"    for file in &files {"},
{"lineNum":"  140","line":"        fc.insert(file);"},
{"lineNum":"  141","line":"    }"},
{"lineNum":"  142","line":"    let repeats = fc.get_repeats();"},
{"lineNum":"  143","line":""},
{"lineNum":"  144","line":"    // use a Box to put the Selector and Actor on the heap as trait objects"},
{"lineNum":"  145","line":"    // different selectors or actors are different sizes (e.g. test_fs contains"},
{"lineNum":"  146","line":"    //  lots of data but real_fs has none), and the stack size must be known"},
{"lineNum":"  147","line":"    //  at compile time but the selector type is only known at runtime"},
{"lineNum":"  148","line":"    //  all boxes are the same size (a pointer)"},
{"lineNum":"  149","line":"    // this has the same small performance hit as C++ inheritance because it"},
{"lineNum":"  150","line":"    //  is basically a vtable"},
{"lineNum":"  151","line":"    // this works because we impl\'d these traits for Box<T>"},
{"lineNum":"  152","line":""},
{"lineNum":"  153","line":"    // select which of the duplicates are \"true\" and act on the others"},
{"lineNum":"  154","line":"    let mut selector: Box<Selector<RealFileSystem>> = {"},
{"lineNum":"  155","line":"        // `--newest-file` or `--path-len` (default)"},
{"lineNum":"  156","line":"        if matches.is_present(\"newest-file\") {"},
{"lineNum":"  157","line":"            Box::new(DateSelect::new(fs))"},
{"lineNum":"  158","line":"        } else {"},
{"lineNum":"  159","line":"            Box::new(PathSelect::new(fs))"},
{"lineNum":"  160","line":"        }"},
{"lineNum":"  161","line":"    };"},
{"lineNum":"  162","line":"    // invert selector if necessary (e.g. use longest path instead of shortest)"},
{"lineNum":"  163","line":"    if matches.is_present(\"invert-selector\") {"},
{"lineNum":"  164","line":"        selector.reverse();"},
{"lineNum":"  165","line":"    }"},
{"lineNum":"  166","line":"    let selector = selector; // remove mutability"},
{"lineNum":"  167","line":""},
{"lineNum":"  168","line":"    // determine what action should be taken on non-selected files"},
{"lineNum":"  169","line":"    let mut actor: Box<FileActor<RealFileSystem, Box<Selector<RealFileSystem>>>> = {"},
{"lineNum":"  170","line":"        // `--link`, `--delete`, or `--print` (default)"},
{"lineNum":"  171","line":"        if matches.is_present(\"link\") {"},
{"lineNum":"  172","line":"            Box::new(FileLinker::new(fs, selector))"},
{"lineNum":"  173","line":"        } else if matches.is_present(\"delete\") {"},
{"lineNum":"  174","line":"            Box::new(FileDeleter::new(fs, selector))"},
{"lineNum":"  175","line":"        } else {"},
{"lineNum":"  176","line":"            Box::new(FilePrinter::new(fs, selector))"},
{"lineNum":"  177","line":"        }"},
{"lineNum":"  178","line":"    };"},
{"lineNum":"  179","line":""},
{"lineNum":"  180","line":"    // act on all sets of duplicates"},
{"lineNum":"  181","line":"    for dups in repeats {"},
{"lineNum":"  182","line":"        actor.act(dups);"},
{"lineNum":"  183","line":"    }"},
{"lineNum":"  184","line":"}"},
]};
var percent_low = 25;var percent_high = 75;
var header = { "command" : "smllr-cd1387de2be9f35d", "date" : "2017-11-27 19:54:30", "instrumented" : 6, "covered" : 6,};
var merged_data = [];
